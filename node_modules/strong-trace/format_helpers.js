"use strict";

module.exports.findActualEnd = findActualEnd
module.exports.getLeadingIndent = getLeadingIndent

var ws = /\s/
function findActualEnd(content, index) {
  var backtrack = 0
  while (index - backtrack > 0 && ws.test(content.slice(index - backtrack - 1, index - backtrack))) {
    backtrack++
  }
  return index - backtrack
}

function getLeadingIndent(content, index) {
  // Look at up to the 50 previous characters to find the leading whitespace
  // for this index
  var chunkStart = Math.max(index - 50, 0)
  var precedingChunk = content.slice(chunkStart, index)
  var indentMatch = /\S(\s*)$/.exec(precedingChunk)
  if (indentMatch) {
    return indentMatch[1]
  }
  return ""
}
